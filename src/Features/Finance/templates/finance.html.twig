{% extends 'layouts/base.html.twig' %}

{% block title %}{{ title }} - Catering Molagis{% endblock %}

{% block stylesheets %}
  {{ parent() }}
  <link rel="stylesheet" href="/css/flatpickr.min.css">
  <style>
    .summary-card {
      border-left: 4px solid var(--tblr-primary);
    }
    .category-badge {
      font-size: 0.75rem;
    }
    .amount-cell {
      font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
      font-weight: 600;
    }
  </style>
{% endblock %}

{% block content %}
  <!-- Page Header -->
  <div class="page-header d-print-none">
    <div class="container-xl">
      <div class="row g-2 align-items-center">
        <div class="col">
          <div class="page-pretitle">Management</div>
          <h2 class="page-title">ðŸ’° Finance</h2>
          <div class="text-muted mt-1">{{ date_subtitle|default('') }}</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Page Body -->
  <div class="page-body">
    <div class="container-xl">
      {% if categories_error or summary_error or records_error %}
        <div class="alert alert-danger" role="alert">
          <h4 class="alert-title">Error Occurred!</h4>
          <div class="text-secondary">
            {% if categories_error %}{{ categories_error }}<br>{% endif %}
            {% if summary_error %}{{ summary_error }}<br>{% endif %}
            {% if records_error %}{{ records_error }}{% endif %}
          </div>
        </div>
      {% endif %}

      <div class="row">
        <!-- Left Column: Input Form -->
        <div class="col-lg-4 mb-4">
          <div class="card">
            <div class="card-header">
              <h3 class="card-title">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                  <path d="M12 5l0 14"/>
                  <path d="M5 12l14 0"/>
                </svg>
                Add Expense
              </h3>
            </div>
            <div class="card-body">
              <form id="expense-form">
                <div class="mb-3">
                  <label for="transaction-date" class="form-label">Transaction Date</label>
                  <input type="text" class="form-control" id="transaction-date" name="transaction_date" placeholder="Select date" required>
                </div>

                <div class="mb-3">
                  <label for="category-select" class="form-label">Category</label>
                  <select class="form-select" id="category-select" name="category_id" required>
                    <option value="" disabled selected>Select category</option>
                    {% for category in categories %}
                      <option value="{{ category.id }}">{{ category.display_name }}</option>
                    {% endfor %}
                  </select>
                </div>

                <div class="mb-3">
                  <label for="amount-input" class="form-label">Amount (Rp)</label>
                  <input type="number" class="form-control" id="amount-input" name="amount" placeholder="Enter amount" min="0" step="1" required>
                </div>

                <div class="mb-3">
                  <label for="description-input" class="form-label">Description</label>
                  <textarea class="form-control" id="description-input" name="description" placeholder="Optional description" rows="3"></textarea>
                </div>

                <div class="d-grid">
                  <button type="submit" class="btn btn-primary" id="submit-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                      <path d="M5 12l5 5l10 -10"/>
                    </svg>
                    <span class="btn-text">Save Transaction</span>
                    <span class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
                  </button>
                </div>
              </form>
            </div>
          </div>

          <!-- Quick Categories -->
          <div class="card mt-3">
            <div class="card-header">
              <h3 class="card-title">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                  <path d="M9 12l2 2l4 -4"/>
                  <path d="M21 12c0 4.97 -4.03 9 -9 9s-9 -4.03 -9 -9s4.03 -9 9 -9s9 4.03 9 9"/>
                </svg>
                Quick Categories
              </h3>
            </div>
            <div class="card-body">
              <div class="d-grid gap-2">
                {% for category in categories|slice(0, 5) %}
                  <button type="button" class="btn btn-outline-secondary btn-sm quick-category-btn" data-category-id="{{ category.id }}" data-category-name="{{ category.display_name }}">
                    {{ category.display_name }}
                  </button>
                {% endfor %}
              </div>
            </div>
          </div>

          <!-- Utilities -->
          <div class="card mt-3">
            <div class="card-header">
              <h3 class="card-title">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                  <path d="M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z"/>
                  <path d="M9 12a3 3 0 1 0 6 0a3 3 0 0 0 -6 0"/>
                </svg>
                Utilities
              </h3>
            </div>
            <div class="card-body">
              <div class="d-grid gap-2">
                <button type="button" class="btn btn-outline-primary btn-sm" data-bs-toggle="modal" data-bs-target="#create-label-modal">
                  <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                    <path d="M12 5l0 14"/>
                    <path d="M5 12l14 0"/>
                  </svg>
                  Buat Label Baru
                </button>
                <button type="button" class="btn btn-outline-secondary btn-sm" id="export-data-btn">
                  <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                    <path d="M14 3v4a1 1 0 0 0 1 1h4"/>
                    <path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z"/>
                    <path d="M12 11v6"/>
                    <path d="M9 14l3 3l3 -3"/>
                  </svg>
                  Export Data
                </button>
                <button type="button" class="btn btn-outline-info btn-sm" id="import-data-btn">
                  <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                    <path d="M14 3v4a1 1 0 0 0 1 1h4"/>
                    <path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z"/>
                    <path d="M12 11v6"/>
                    <path d="M9 17l3 -3l3 3"/>
                  </svg>
                  Import Data
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Right Column: Summary & History -->
        <div class="col-lg-8">
          <!-- Summary Cards -->
          <div class="row mb-4">
            <div class="col-sm-6 mb-3">
              <div class="card summary-card">
                <div class="card-body">
                  <div class="d-flex align-items-center">
                    <div class="subheader">Total Expenses This Month</div>
                    <div class="ms-auto lh-1">
                      <div class="h3 m-0 amount-cell text-danger blur-target">
                        Rp {{ summary.total_expenses | default(0) | number_format(0, ',', '.') }}
                      </div>
                    </div>
                  </div>
                  <div class="d-flex align-items-baseline">
                    <div class="h1 me-2">ðŸ“Š</div>
                    <div class="me-auto">
                      <span class="text-green d-inline-flex align-items-center lh-1">
                        {{ summary.total_records | default(0) }} transactions
                      </span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-sm-6 mb-3">
              <div class="card">
                <div class="card-body">
                  <div class="d-flex align-items-center">
                    <div class="subheader">Period</div>
                    <div class="ms-auto lh-1">
                      <div class="h5 m-0">
                        {% if summary.period %}
                          {{ summary.period.start_date | date('d/m') }} - {{ summary.period.end_date | date('d/m/Y') }}
                        {% else %}
                          This Month
                        {% endif %}
                      </div>
                    </div>
                  </div>
                  <div class="d-flex align-items-baseline">
                    <div class="h1 me-2">ðŸ“…</div>
                    <div class="me-auto">
                      <span class="text-muted d-inline-flex align-items-center lh-1">
                        Active filter
                      </span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Filters -->
          <div class="card mb-4">
            <div class="card-header">
              <h3 class="card-title">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                  <path d="M5.5 5h13a1 1 0 0 1 0.5 1.5l-5 5.5l0 7l-4 -3l0 -4l-5 -5.5a1 1 0 0 1 0.5 -1.5"/>
                </svg>
                Filter Transactions
              </h3>
            </div>
            <div class="card-body">
              <form id="filter-form">
                <div class="row g-3 mb-3">
                  <div class="col-md-4">
                    <label for="filter-start-date" class="form-label">From Date</label>
                    <input type="text" class="form-control" id="filter-start-date" name="start_date" placeholder="Select start date" value="{{ current_start_date }}">
                  </div>
                  <div class="col-md-4">
                    <label for="filter-end-date" class="form-label">To Date</label>
                    <input type="text" class="form-control" id="filter-end-date" name="end_date" placeholder="Select end date" value="{{ current_end_date }}">
                  </div>
                  <div class="col-md-4">
                    <label for="filter-category" class="form-label">Category</label>
                    <select class="form-select" id="filter-category" name="category_id">
                      <option value="">All Categories</option>
                      {% for category in categories %}
                        <option value="{{ category.id }}" {{ current_category_id == category.id ? 'selected' : '' }}>{{ category.display_name }}</option>
                      {% endfor %}
                    </select>
                  </div>
                </div>

                <div class="row g-2">
                  <div class="col">
                    <div class="row g-2">
                      <div class="col-auto">
                        <button type="submit" class="btn btn-primary" id="filter-btn">
                          <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                            <path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0"/>
                            <path d="M21 21l-6 -6"/>
                          </svg>
                          <span class="btn-text">Filter</span>
                          <span class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
                        </button>
                      </div>
                      <div class="col-auto">
                        <button type="button" class="btn btn-secondary" id="clear-filter-btn">
                          <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                            <path d="M18 6l-12 12"/>
                            <path d="M6 6l12 12"/>
                          </svg>
                          Reset
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </form>
            </div>
          </div>

          <!-- Transaction History -->
          <div class="card">
            <div class="card-header">
              <h3 class="card-title">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                  <path d="M9 5h-2a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-12a2 2 0 0 0 -2 -2h-2"/>
                  <path d="M9 3m0 2a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v0a2 2 0 0 1 -2 2h-2a2 2 0 0 1 -2 -2z"/>
                  <path d="M9 12l2 2l4 -4"/>
                </svg>
                Transaction History
              </h3>
            </div>
            <div class="table-responsive">
              <table class="table table-vcenter card-table" id="records-table">
                <thead>
                  <tr>
                    <th>Date</th>
                    <th>Description</th>
                    <th class="text-end">Amount</th>
                    <th class="w-1">Actions</th>
                  </tr>
                </thead>
                <tbody id="records-tbody">
                  {% for record in records %}
                    <tr data-record-id="{{ record.id }}">
                      <td>
                        <div class="text-muted">{{ record.transaction_date | date('d/m/Y', 'Asia/Makassar') }}</div>
                      </td>
                      <td>
                        <div class="text-truncate" style="max-width: 200px;" title="{{ record.description }}">
                          {{ record.description | default('-') }}
                        </div>
                        <div class="mt-1">
                          <span class="badge category-badge bg-secondary-lt">
                            {{ record.expense_categories.display_name | default('Other') }}
                          </span>
                        </div>
                      </td>
                      <td class="text-end amount-cell text-danger blur-target">
                        Rp {{ record.amount | number_format(0, ',', '.') }}
                      </td>
                      <td>
                        <div class="btn-list flex-nowrap">
                          <button class="btn btn-sm btn-outline-primary edit-record-btn" data-record-id="{{ record.id }}" title="Edit">
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                              <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                              <path d="M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1"/>
                              <path d="M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z"/>
                              <path d="M16 5l3 3"/>
                            </svg>
                          </button>
                          <button class="btn btn-sm btn-outline-danger delete-record-btn" data-record-id="{{ record.id }}" title="Delete">
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                              <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                              <path d="M4 7l16 0"/>
                              <path d="M10 11l0 6"/>
                              <path d="M14 11l0 6"/>
                              <path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12"/>
                              <path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3"/>
                            </svg>
                          </button>
                        </div>
                      </td>
                    </tr>
                  {% else %}
                    <tr>
                      <td colspan="4" class="text-center text-muted py-4">
                        <div class="empty">
                          <div class="empty-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                              <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                              <path d="M14 3v4a1 1 0 0 0 1 1h4"/>
                              <path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z"/>
                              <path d="M10 12l4 4m0 -4l-4 4"/>
                            </svg>
                          </div>
                          <p class="empty-title">No transactions yet</p>
                          <p class="empty-subtitle text-muted">
                            Start adding expense transactions using the form on the left.
                          </p>
                        </div>
                      </td>
                    </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
            <div class="card-footer d-flex align-items-center">
              <p class="m-0 text-secondary" id="records-info">
                <span id="records-count">Loading...</span>
              </p>
              <div class="d-flex align-items-center ms-auto">
                <div class="me-3">
                  <select class="form-select form-select-sm" id="records-per-page" style="width: auto;">
                    <option value="50">50 per page</option>
                    <option value="100">100 per page</option>
                    <option value="250">250 per page</option>
                    <option value="500" selected>500 per page</option>
                  </select>
                </div>
                <ul class="pagination m-0" id="pagination">
                  <!-- Pagination will be handled by JavaScript -->
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Edit Modal -->
  <div class="modal modal-blur fade" id="edit-record-modal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Edit Transaction</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="edit-expense-form">
            <div class="row">
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="edit-transaction-date" class="form-label">Transaction Date</label>
                  <input type="text" class="form-control" id="edit-transaction-date" name="transaction_date" placeholder="Select date" required>
                </div>
              </div>
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="edit-amount" class="form-label">Amount</label>
                  <div class="input-group">
                    <span class="input-group-text">Rp</span>
                    <input type="number" class="form-control" id="edit-amount" name="amount" placeholder="0" min="1" step="1" required>
                  </div>
                </div>
              </div>
            </div>
            <div class="mb-3">
              <label for="edit-category" class="form-label">Category</label>
              <select class="form-select" id="edit-category" name="category_id" required>
                <option value="">Select category</option>
                {% for category in categories %}
                  <option value="{{ category.id }}">{{ category.display_name }}</option>
                {% endfor %}
              </select>
            </div>
            <div class="mb-3">
              <label for="edit-description" class="form-label">Description</label>
              <textarea class="form-control" id="edit-description" name="description" rows="3" placeholder="Optional description"></textarea>
            </div>
            <input type="hidden" id="edit-record-id" name="record_id">
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-link link-secondary me-auto" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary" id="update-record-btn">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
              <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
              <path d="M5 12l5 5l10 -10"/>
            </svg>
            Update Transaction
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <div class="modal modal-blur fade" id="delete-confirm-modal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-sm modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-body text-center">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon mb-2 text-danger icon-lg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M12 9v4"/>
            <path d="M10.363 3.591l-8.106 13.534a1.914 1.914 0 0 0 1.636 2.871h16.214a1.914 1.914 0 0 0 1.636 -2.87l-8.106 -13.536a1.914 1.914 0 0 0 -3.274 0z"/>
            <path d="M12 16h.01"/>
          </svg>
          <h5 id="delete-confirm-modal-title" class="modal-title">Delete Transaction</h5>
          <div id="delete-confirm-modal-message" class="modal-message">Are you sure you want to delete this transaction? This action cannot be undone.</div>
        </div>
        <div class="modal-footer justify-content-center">
          <button type="button" class="btn btn-link link-secondary me-auto" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-danger" id="delete-confirm-modal-confirm">Delete</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Create Label Modal -->
  <div class="modal modal-blur fade" id="create-label-modal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
              <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
              <path d="M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1"/>
              <path d="M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z"/>
              <path d="M16 5l3 3"/>
            </svg>
            Buat Label Baru
          </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="create-label-form">
            <div class="row">
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="label-name" class="form-label">Nama Label</label>
                  <input type="text" class="form-control" id="label-name" name="name" placeholder="Masukkan nama label" required>
                  <div class="form-text">Nama internal untuk sistem (tanpa spasi, gunakan underscore)</div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="label-display-name" class="form-label">Nama Tampilan</label>
                  <input type="text" class="form-control" id="label-display-name" name="display_name" placeholder="Masukkan nama tampilan" required>
                  <div class="form-text">Nama yang akan ditampilkan di interface</div>
                </div>
              </div>
            </div>
            <div class="mb-3">
              <label for="label-color" class="form-label">Warna Label</label>
              <div class="row g-2">
                <div class="col-auto">
                  <input type="color" class="form-control form-control-color" id="label-color" name="color" value="#206bc4" title="Pilih warna">
                </div>
                <div class="col">
                  <select class="form-select" id="label-preset-colors">
                    <option value="">Pilih warna preset</option>
                    <option value="#206bc4" data-color="#206bc4">Biru (Primary)</option>
                    <option value="#79a6dc" data-color="#79a6dc">Biru Muda</option>
                    <option value="#d63939" data-color="#d63939">Merah</option>
                    <option value="#f59f00" data-color="#f59f00">Kuning</option>
                    <option value="#2fb344" data-color="#2fb344">Hijau</option>
                    <option value="#ae3ec9" data-color="#ae3ec9">Ungu</option>
                    <option value="#f59f00" data-color="#f59f00">Orange</option>
                    <option value="#6c757d" data-color="#6c757d">Abu-abu</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="mb-3">
              <label for="label-description" class="form-label">Deskripsi (Opsional)</label>
              <textarea class="form-control" id="label-description" name="description" rows="3" placeholder="Deskripsi singkat tentang label ini"></textarea>
            </div>
            <div class="mb-3">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="label-is-active" name="is_active" checked>
                <label class="form-check-label" for="label-is-active">
                  Label Aktif
                </label>
                <div class="form-text">Label aktif akan tersedia untuk digunakan dalam transaksi</div>
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-link link-secondary me-auto" data-bs-dismiss="modal">Batal</button>
          <button type="button" class="btn btn-primary" id="create-label-btn">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
              <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
              <path d="M5 12l5 5l10 -10"/>
            </svg>
            Buat Label
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast -->
  {% include 'partials/toast.html.twig' %}
{% endblock %}

{% block javascripts %}
  {{ parent() }}
  <script src="/js/flatpickr.min.js"></script>
  <script src="/js/flatpickr-l10n/id.js"></script>
  <script>
    // Pass pagination data to JavaScript
    window.financePageData = {
      currentPage: {{ current_page|default(1) }},
      currentLimit: {{ current_limit|default(500) }},
      totalRecords: {{ total_records|default(0) }},
      totalPages: {{ total_pages|default(1) }}
    };
  </script>
  <script type="module" src="/js/app/finance.js?v={{ 'now'|date('U') }}"></script>
{% endblock %}
